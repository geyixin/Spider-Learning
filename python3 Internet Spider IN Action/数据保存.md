# :baby_bottle:数据保存

+ :aerial_tramway: [txt](#txt)
+ :bamboo:  [JSON](#JSON)
+ :cake: [CSV](#CSV)
+ :dancer: [数据库](#数据库)

## txt

> 很常见。

## JSON

+ JavaScript Object Notation，JavaScript对象标记，通过对 对象和数组的组合去表示数据，构造简洁但结构化程度很高，轻量级的数据交换格式。

>+ 与str的简单转换、索引
>```python3
>import json
>
>str = '[{"a":1,"b":2},{"A":11,"B":22}]'
>print(type(str))
>data = json.loads(str)  # json编码
>print(data)
>print(type(data))
>print(data[0]['a'])
>print(data[1].get('A'))	# 11
>print(data[1].get('A', 2))	# 11
>print(data[1].get('C', 2))	# 2
>da = json.dumps(data)   # json解码
>print(da)
>print(type(da))
>```
>+ 保存
>```python3
>import json
>
>str = '[{"a":1,"b":2},{"A":11,"B":22}]'
>with open('data.json', 'w', encoding='utf-8') as f:
>    f.write(json.dumps(str, indent=2, ensure_ascii=False))  # indent=2,缩进两个字符
>```

## CSV

+ Comma-Separated Values，逗号分隔值/字符分隔值，文件以纯文本形式存储表格数据。

>+ 写
>```python3
>import csv
>
>with open('data.csv', 'w', newline='' ,encoding='utf-8') as cv:
>    writer = csv.writer(cv, delimiter=' ')
>    writer.writerow(['id', 'name', 'age'])
>    writer.writerow(['1', 'tom', '12'])
>    writer.writerow(['2', 'mike', '13'])
>    writer.writerows([['3', 'tt', '12'],['4', 'mm', '12']])
># 注意： 保存的时候，需要加上 newline=''， 不然在python3中，每会保存一行，就会出现一行空格。
>```
>+ 读
>```python3
>import csv
>
>with open('data.csv', 'r', encoding='utf-8') as cv:
>    read = csv.reader(cv)
>    for row in read:
>        print(row)
>'''
>可以用pandas读csv
>'''
>import pandas
>
>df = pandas.read_csv('data.csv')
>print(df)
>```

## 数据库

+ [关系型数据库](#关系型数据库)
+ [非关系型数据库](#非关系型数据库)

### :a: 关系型数据库

+ 关系型数据库，说白了，就是基于关系的数据库，而关系就是二维表体现的，关系型数据库的存储方式就是行和列形成的二维表，每一行是一条记录，每一列是是个字段。
+ SQLite、MySQL、Oracle、SQLServer等。
>+ 连接数据库
>```python3
>import pymysql
>
>db = pymysql.connect(host='localhost', user='root', password='1234', port=3306)
>cursor = db.cursor()
>cursor.execute('SELECT VERSION()')
>data = cursor.fetchall()
>print('Database version:', data)
>cursor.execute("CREATE DATABASE ss DEFAULT CHARACTER SET UTF8MB3")
>db.close()
>```
>
>+ 创建表
>
>```
>import pymysql
>
>db = pymysql.connect(host='localhost', user='root', password='1234', port=3306, db='spiders')
>cursor = db.cursor()
>sql = 'CREATE TABLE IF NOT EXISTS students (id VARCHAR(255) NOT NULL, ' \
>      'name VARCHAR(255) NOT NULL, age INT NOT NULL, PRIMARY KEY (id))'
>cursor.execute(sql)
>db.close()
>```
>
>+ 插入数据
>
>```python3
>import pymysql
>
>id = '10170103'
>user = 'xiaoming'
>age = 25
>
>db = pymysql.connect(host='localhost', user='root', password='1234', port=3306, db='spiders')
>cursor = db.cursor()
>sql = 'INSERT INTO students(id, name, age) values (%s, %s, %s)'
>try:
>    cursor.execute(sql, (id, user, age))
>    db.commit()   # commit之后才实现真正意义上的插入
>except:
>    db.rollback() # 回滚，表示啥都没发生。要么做完要么没做，不存在做一半的情况。
>db.close()
>```
>
>补充：
>
>上面提到的rollback涉及事务的概念。事务共有4个性：
>
>原子性：	事务不可分割，要么做了，要么没做；
>
>一致性：事务必须使数据库从一个一致性状态变到另一个一致性状态。与原子性密切相关；
>
>隔离性：一个事务的执行不能被其它事务干扰，并发执行的事务之间不能相互干扰；
>
>持久性：又称永久性，事务一旦提交，它对数据库中的数据的改变是永久性的。

### :b: 非关系型数据库
>

